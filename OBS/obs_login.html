
<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>OBS Login</title>
<link rel="stylesheet" href="assets/style.css">
<script defer src="assets/app.js"></script>
</head><body>
<div class="container">
  <div class="header">
    <div class="brand"><span class="dot"></span> OBS Login</div>
    <div class="nav"><a href="index.html">Home</a><a href="obs_register.html">Register</a></div>
  </div>
  <div class="grid cols-2">
    <div class="card">
      <h2>Login</h2>
      <div class="grid">
        <input id="username" placeholder="Username">
        <input id="password" type="password" placeholder="Password">
        <button class="btn" id="loginBtn">Login</button>
      </div>
      <p class="small">Tip: use the <span class="kbd">Register</span> page if you don't have an account.</p>
    </div>
    <div class="card">
      <h2>Company / Shop Details</h2>
      <div class="grid">
        <input id="cname" placeholder="Company / Shop Name">
        <input id="caddr" placeholder="Address">
        <input id="cpan" placeholder="PAN Number">
        <button class="btn secondary" id="saveCompanyBtn">Save Details</button>
      </div>
      <p class="small">Saved details appear on the bill header.</p>
    </div>
  </div>
  <footer>Â© <span id="y"></span> OBS. All rights reserved.</footer>
</div>
<script>
document.getElementById('y').textContent = new Date().getFullYear();
const co = getCompanyDetails();
document.getElementById('cname').value = co.name||'';
document.getElementById('caddr').value = co.address||'';
document.getElementById('cpan').value = co.pan||'';
document.getElementById('saveCompanyBtn').onclick = ()=>{
  saveCompanyDetails({name: cname.value.trim(), address: caddr.value.trim(), pan: cpan.value.trim()});
  toast('Company details saved','success');
};
document.getElementById('loginBtn').onclick = ()=>{
  const u = username.value.trim(); const p = password.value;
  const res = loginUser(u,p);
  if(!res.ok){ toast(res.msg,'error'); return; }
  toast('Welcome '+res.user.displayName,'success');
  const urlParams = new URLSearchParams(location.search);
  const next = urlParams.get('next') || 'obs_index.html';
  window.location.href = next;
};
</script>
</body></html>
